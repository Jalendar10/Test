Project Structure
lua
Copy
Edit
my-spring-boot-rules/
├── pom.xml
├── src
│   └── main
│       ├── java
│       │   └── com
│       │       └── example
│       │           └── rulesapp
│       │               ├── RulesAppApplication.java
│       │               ├── DataInitializer.java
│       │               ├── controller
│       │               │   ├── HomeController.java
│       │               │   ├── RulesConfigController.java
│       │               │   ├── RanRulesController.java
│       │               │   └── TestController.java
│       │               ├── model
│       │               │   ├── ApplicationData.java
│       │               │   ├── FieldDefinition.java
│       │               │   ├── RuleDefinition.java
│       │               │   ├── RuleResult.java            <-- Reused for storing rule results
│       │               │   └── StoredRuleResult.java       <-- Embeddable for persistent results
│       │               ├── repository
│       │               │   ├── ApplicationDataRepository.java
│       │               │   ├── FieldDefinitionRepository.java
│       │               │   └── RuleDefinitionRepository.java
│       │               └── service
│       │                   ├── RulesEngineService.java
│       │                   └── DataService.java
│       └── resources
│           ├── application.properties
│           └── templates
│               ├── home.html
│               ├── createApplication.html
│               ├── rulesConfig.html
│               ├── editRule.html
│               ├── ranrules.html
│               ├── ranrulesDetails.html
│               └── test.html
└── ...
Below is the complete code for each file.

1) pom.xml
xml
Copy
Edit
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>my-spring-boot-rules</artifactId>
    <version>1.0.0</version>
    <name>my-spring-boot-rules</name>

    <properties>
        <java.version>1.8</java.version>
        <spring.boot.version>2.6.14</spring.boot.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Starter Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- Spring Boot Starter Thymeleaf -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- Spring Boot Starter Data JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- H2 Database (in-memory) -->
        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- Lombok (optional) -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.24</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- Spring Boot Maven Plugin -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring.boot.version}</version>
            </plugin>
        </plugins>
    </build>

</project>
2) application.properties
properties
Copy
Edit
spring.datasource.url=jdbc:h2:mem:rulesdb;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.jpa.hibernate.ddl-auto=update

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
Enables an in-memory H2 DB at jdbc:h2:mem:rulesdb, with the console at /h2-console.

3) RulesAppApplication.java
java
Copy
Edit
package com.example.rulesapp;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class RulesAppApplication {
    public static void main(String[] args) {
        SpringApplication.run(RulesAppApplication.class, args);
    }
}
Main entry point.

4) DataInitializer.java
On startup, it inserts 30 fields if none exist yet.

java
Copy
Edit
package com.example.rulesapp;

import com.example.rulesapp.model.FieldDefinition;
import com.example.rulesapp.service.DataService;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class DataInitializer implements CommandLineRunner {

    private final DataService dataService;

    public DataInitializer(DataService dataService) {
        this.dataService = dataService;
    }

    @Override
    public void run(String... args) {
        if (!dataService.getAllFields().isEmpty()) {
            return; // Already have fields
        }

        // Insert 30 predefined fields
        dataService.createField(new FieldDefinition("name",           "TEXT",   "John Doe"));
        dataService.createField(new FieldDefinition("age",            "NUMBER", "25"));
        dataService.createField(new FieldDefinition("sales",          "NUMBER", "1000"));
        dataService.createField(new FieldDefinition("volume",         "NUMBER", "50"));
        dataService.createField(new FieldDefinition("product",        "TEXT",   "Sample Product"));
        dataService.createField(new FieldDefinition("location",       "TEXT",   "NY"));
        dataService.createField(new FieldDefinition("phone",          "TEXT",   "1234567890"));
        dataService.createField(new FieldDefinition("email",          "TEXT",   "user@example.com"));
        dataService.createField(new FieldDefinition("creditScore",    "NUMBER", "700"));
        dataService.createField(new FieldDefinition("annualIncome",   "NUMBER", "50000"));
        dataService.createField(new FieldDefinition("monthlyExpenses","NUMBER", "1000"));
        dataService.createField(new FieldDefinition("membershipType", "TEXT",   "Basic"));
        dataService.createField(new FieldDefinition("region",         "TEXT",   "NorthEast"));
        dataService.createField(new FieldDefinition("discount",       "NUMBER", "10"));
        dataService.createField(new FieldDefinition("loyaltyPoints",  "NUMBER", "100"));
        dataService.createField(new FieldDefinition("transactionCount","NUMBER","5"));
        dataService.createField(new FieldDefinition("numberOfDependents","NUMBER","2"));
        dataService.createField(new FieldDefinition("occupation",     "TEXT",   "Engineer"));
        dataService.createField(new FieldDefinition("rating",         "NUMBER", "4"));
        dataService.createField(new FieldDefinition("remarks",        "TEXT",   ""));
        dataService.createField(new FieldDefinition("monthlySavings", "NUMBER", "500"));
        dataService.createField(new FieldDefinition("houseOwnership", "TEXT",   "Rented"));
        dataService.createField(new FieldDefinition("cardType",       "TEXT",   "Silver"));
        dataService.createField(new FieldDefinition("gender",         "TEXT",   "Male"));
        dataService.createField(new FieldDefinition("nationality",    "TEXT",   "American"));
        dataService.createField(new FieldDefinition("maritalStatus",  "TEXT",   "Single"));
        dataService.createField(new FieldDefinition("referenceId",    "TEXT",   "REF123"));
        dataService.createField(new FieldDefinition("productCategory","TEXT",   "Consumer Goods"));
        dataService.createField(new FieldDefinition("salesTarget",    "NUMBER", "2000"));
        dataService.createField(new FieldDefinition("comments",       "TEXT",   "N/A"));
    }
}
5) Model Classes
5.1) ApplicationData.java
Stores:

Map of field values
Final decision (e.g. "Ran 2 rules(s), 1 passed, 1 failed")
A list of StoredRuleResult (persistent version of each rule’s pass/fail).
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

@Entity
public class ApplicationData {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ElementCollection
    private Map<String, String> fieldValues; // e.g. {"age":"25","sales":"1000"}

    private String finalDecision; // "Ran X rules(s), X passed, X failed"

    /**
     * The stored rule results at the time of submission.
     * If no rules existed, this will be empty.
     */
    @ElementCollection
    private List<StoredRuleResult> storedResults = new ArrayList<>();

    public ApplicationData() {
    }

    public ApplicationData(Map<String, String> fieldValues) {
        this.fieldValues = fieldValues;
    }

    public Long getId() {
        return id;
    }

    public Map<String, String> getFieldValues() {
        return fieldValues;
    }

    public void setFieldValues(Map<String, String> fieldValues) {
        this.fieldValues = fieldValues;
    }

    public String getFinalDecision() {
        return finalDecision;
    }

    public void setFinalDecision(String finalDecision) {
        this.finalDecision = finalDecision;
    }

    public List<StoredRuleResult> getStoredResults() {
        return storedResults;
    }

    public void setStoredResults(List<StoredRuleResult> storedResults) {
        this.storedResults = storedResults;
    }
}
5.2) FieldDefinition.java
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;

@Entity
public class FieldDefinition {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String fieldName;    // e.g. "age", "sales"
    private String fieldType;    // e.g. "NUMBER", "TEXT"
    private String defaultValue; // e.g. "0"

    public FieldDefinition() {
    }

    public FieldDefinition(String fieldName, String fieldType, String defaultValue) {
        this.fieldName = fieldName;
        this.fieldType = fieldType;
        this.defaultValue = defaultValue;
    }

    public Long getId() {
        return id;
    }

    public String getFieldName() {
        return fieldName;
    }

    public void setFieldName(String fieldName) {
        this.fieldName = fieldName;
    }

    public String getFieldType() {
        return fieldType;
    }

    public void setFieldType(String fieldType) {
        this.fieldType = fieldType;
    }

    public String getDefaultValue() {
        return defaultValue;
    }

    public void setDefaultValue(String defaultValue) {
        this.defaultValue = defaultValue;
    }
}
5.3) RuleDefinition.java
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;

@Entity
public class RuleDefinition {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    /**
     * Example: "age > 18" or "sales >= 500"
     */
    private String expression;

    private String description;

    public RuleDefinition() {
    }

    public RuleDefinition(String expression, String description) {
        this.expression = expression;
        this.description = description;
    }

    public Long getId() {
        return id;
    }

    public String getExpression() {
        return expression;
    }

    public void setExpression(String expression) {
        this.expression = expression;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
}
5.4) RuleResult.java (Transient for new evaluations)
java
Copy
Edit
package com.example.rulesapp.model;

/**
 * For in-memory evaluation. We'll convert it to a StoredRuleResult
 * when we persist it in ApplicationData.
 */
public class RuleResult {

    private Long ruleId;
    private String ruleDescription;
    private boolean passed;
    private String message;

    public RuleResult(Long ruleId, String ruleDescription, boolean passed, String message) {
        this.ruleId = ruleId;
        this.ruleDescription = ruleDescription;
        this.passed = passed;
        this.message = message;
    }

    public Long getRuleId() {
        return ruleId;
    }

    public String getRuleDescription() {
        return ruleDescription;
    }

    public boolean isPassed() {
        return passed;
    }

    public String getMessage() {
        return message;
    }
}
5.5) StoredRuleResult.java (Embeddable for persistent storage)
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.Embeddable;
import java.io.Serializable;

/**
 * An embeddable version of a RuleResult for storing in the DB.
 */
@Embeddable
public class StoredRuleResult implements Serializable {

    private Long ruleId;
    private String ruleDescription;
    private boolean passed;
    private String message;

    public StoredRuleResult() {
    }

    public StoredRuleResult(Long ruleId, String ruleDescription, boolean passed, String message) {
        this.ruleId = ruleId;
        this.ruleDescription = ruleDescription;
        this.passed = passed;
        this.message = message;
    }

    public Long getRuleId() {
        return ruleId;
    }

    public void setRuleId(Long ruleId) {
        this.ruleId = ruleId;
    }

    public String getRuleDescription() {
        return ruleDescription;
    }

    public void setRuleDescription(String ruleDescription) {
        this.ruleDescription = ruleDescription;
    }

    public boolean isPassed() {
        return passed;
    }

    public void setPassed(boolean passed) {
        this.passed = passed;
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }
}
6) Repository Interfaces
6.1) ApplicationDataRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.ApplicationData;
import org.springframework.data.jpa.repository.JpaRepository;

public interface ApplicationDataRepository extends JpaRepository<ApplicationData, Long> {
}
6.2) FieldDefinitionRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.FieldDefinition;
import org.springframework.data.jpa.repository.JpaRepository;

public interface FieldDefinitionRepository extends JpaRepository<FieldDefinition, Long> {
}
6.3) RuleDefinitionRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.RuleDefinition;
import org.springframework.data.jpa.repository.JpaRepository;

public interface RuleDefinitionRepository extends JpaRepository<RuleDefinition, Long> {
}
7) Service Classes
7.1) DataService.java
Manages CRUD for fields, rules, and applications.

java
Copy
Edit
package com.example.rulesapp.service;

import com.example.rulesapp.model.*;
import com.example.rulesapp.repository.ApplicationDataRepository;
import com.example.rulesapp.repository.FieldDefinitionRepository;
import com.example.rulesapp.repository.RuleDefinitionRepository;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class DataService {

    private final FieldDefinitionRepository fieldRepo;
    private final RuleDefinitionRepository ruleRepo;
    private final ApplicationDataRepository appRepo;

    public DataService(FieldDefinitionRepository fieldRepo,
                       RuleDefinitionRepository ruleRepo,
                       ApplicationDataRepository appRepo) {
        this.fieldRepo = fieldRepo;
        this.ruleRepo = ruleRepo;
        this.appRepo = appRepo;
    }

    // Fields
    public List<FieldDefinition> getAllFields() {
        return fieldRepo.findAll();
    }

    public FieldDefinition createField(FieldDefinition fieldDefinition) {
        return fieldRepo.save(fieldDefinition);
    }

    // Rules
    public List<RuleDefinition> getAllRules() {
        return ruleRepo.findAll();
    }

    public RuleDefinition createRule(RuleDefinition ruleDefinition) {
        return ruleRepo.save(ruleDefinition);
    }

    public RuleDefinition getRuleById(Long id) {
        return ruleRepo.findById(id).orElse(null);
    }

    // Applications
    public ApplicationData saveApplicationData(ApplicationData applicationData) {
        return appRepo.save(applicationData);
    }

    public List<ApplicationData> getAllApplications() {
        return appRepo.findAll();
    }

    public ApplicationData getApplicationById(Long id) {
        return appRepo.findById(id).orElse(null);
    }
}
7.2) RulesEngineService.java
Evaluates rules in-memory, returning a list of RuleResult. We’ll convert those to StoredRuleResult when saving.

java
Copy
Edit
package com.example.rulesapp.service;

import com.example.rulesapp.model.ApplicationData;
import com.example.rulesapp.model.RuleDefinition;
import com.example.rulesapp.model.RuleResult;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

@Service
public class RulesEngineService {

    /**
     * Evaluate all given rules against the application’s field values.
     * Returns a list of results (pass/fail).
     */
    public List<RuleResult> evaluateRules(ApplicationData applicationData, List<RuleDefinition> rules) {
        Map<String, String> fieldValues = applicationData.getFieldValues();
        List<RuleResult> results = new ArrayList<>();

        for (RuleDefinition rule : rules) {
            boolean passed = evaluateExpression(rule.getExpression(), fieldValues);
            String message = passed ? "Rule Passed" : "Rule Failed";

            results.add(new RuleResult(
                    rule.getId(),
                    rule.getDescription(),
                    passed,
                    message
            ));
        }
        return results;
    }

    private boolean evaluateExpression(String expression, Map<String, String> fieldValues) {
        if (expression == null || expression.trim().isEmpty()) return false;

        try {
            String[] parts = expression.split(" ");
            if (parts.length == 3) {
                String fieldName = parts[0];
                String operator = parts[1];
                String thresholdStr = parts[2];

                String actualValueStr = fieldValues.get(fieldName);
                if (actualValueStr == null) {
                    return false;
                }

                double actualVal = Double.parseDouble(actualValueStr);
                double thresholdVal = Double.parseDouble(thresholdStr);

                switch (operator) {
                    case ">":  return actualVal > thresholdVal;
                    case ">=": return actualVal >= thresholdVal;
                    case "<":  return actualVal < thresholdVal;
                    case "<=": return actualVal <= thresholdVal;
                    case "==": return actualVal == thresholdVal;
                    default:   return false;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return false;
    }
}
8) Controller Classes
8.1) HomeController.java
/home – lists apps, includes a link (modal) to see each app’s data.
/createApplication – form to create an app.
/submitApplication – saves the app, runs the rules, stores results in DB.
java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.*;
import com.example.rulesapp.service.DataService;
import com.example.rulesapp.service.RulesEngineService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;

import org.springframework.web.bind.annotation.RequestParam;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Controller
public class HomeController {

    private final DataService dataService;
    private final RulesEngineService rulesEngineService;

    public HomeController(DataService dataService, RulesEngineService rulesEngineService) {
        this.dataService = dataService;
        this.rulesEngineService = rulesEngineService;
    }

    /**
     * Shows all existing applications (with final decisions), 
     * plus modals to display each application’s submitted data.
     */
    @GetMapping({"/", "/home"})
    public String home(Model model) {
        List<ApplicationData> apps = dataService.getAllApplications();
        model.addAttribute("applications", apps);

        return "home"; // We'll use modals in the HTML to show each app's fieldValues
    }

    /**
     * Displays a form with all fields (using their default values).
     */
    @GetMapping("/createApplication")
    public String showCreateApplicationForm(Model model) {
        List<FieldDefinition> fields = dataService.getAllFields();
        model.addAttribute("fields", fields);

        // Build map of fieldName -> defaultValue
        Map<String, String> fieldMap = new HashMap<>();
        for (FieldDefinition fd : fields) {
            String defVal = (fd.getDefaultValue() == null) ? "" : fd.getDefaultValue();
            fieldMap.put(fd.getFieldName(), defVal);
        }
        model.addAttribute("fieldMap", fieldMap);

        return "createApplication";
    }

    /**
     * Submits the new application, runs all current rules,
     * stores the results (so future rule changes won't affect old apps).
     */
    @PostMapping("/submitApplication")
    public String submitApplication(@RequestParam("fieldNames") String[] fieldNames,
                                    @RequestParam("fieldValues") String[] fieldValues) {
        // Build fieldName->value map
        Map<String, String> fvMap = new HashMap<>();
        for (int i = 0; i < fieldNames.length; i++) {
            fvMap.put(fieldNames[i], fieldValues[i]);
        }

        // Create the application
        ApplicationData appData = new ApplicationData(fvMap);
        appData = dataService.saveApplicationData(appData);

        // Evaluate the rules that currently exist
        List<RuleDefinition> allRules = dataService.getAllRules();
        List<RuleResult> results = rulesEngineService.evaluateRules(appData, allRules);

        // Convert those results to persistent StoredRuleResult objects
        List<StoredRuleResult> storedResults = new ArrayList<>();
        for (RuleResult rr : results) {
            StoredRuleResult srr = new StoredRuleResult(
                    rr.getRuleId(),
                    rr.getRuleDescription(),
                    rr.isPassed(),
                    rr.getMessage()
            );
            storedResults.add(srr);
        }

        // Count pass/fail
        int total = storedResults.size();
        int passed = (int) storedResults.stream().filter(StoredRuleResult::isPassed).count();
        int failed = total - passed;

        String finalDec = String.format("Ran %d rule(s), %d passed, %d failed", total, passed, failed);
        appData.setFinalDecision(finalDec);
        appData.setStoredResults(storedResults);

        // Save the final outcome
        dataService.saveApplicationData(appData);

        return "redirect:/home";
    }
}
8.2) RulesConfigController.java
Manages fields/rules. Allows you to specify a single-condition rule (field + operator + value).

java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.FieldDefinition;
import com.example.rulesapp.model.RuleDefinition;
import com.example.rulesapp.service.DataService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Controller
@RequestMapping("/rulesConfig")
public class RulesConfigController {

    private final DataService dataService;

    public RulesConfigController(DataService dataService) {
        this.dataService = dataService;
    }

    @GetMapping
    public String showConfigPage(Model model) {
        List<FieldDefinition> fields = dataService.getAllFields();
        List<RuleDefinition> rules = dataService.getAllRules();
        model.addAttribute("fields", fields);
        model.addAttribute("rules", rules);
        return "rulesConfig";
    }

    @PostMapping("/addField")
    public String addField(@RequestParam String fieldName,
                           @RequestParam String fieldType,
                           @RequestParam(required = false) String defaultValue) {
        if (defaultValue == null) defaultValue = "";
        FieldDefinition fd = new FieldDefinition(fieldName, fieldType, defaultValue);
        dataService.createField(fd);
        return "redirect:/rulesConfig";
    }

    /**
     * For a single-condition rule: field + operator + value -> e.g. "age > 18"
     */
    @PostMapping("/addRule")
    public String addRule(@RequestParam String selectedField,
                          @RequestParam String operator,
                          @RequestParam String ruleValue,
                          @RequestParam String description) {
        String expr = selectedField + " " + operator + " " + ruleValue;
        RuleDefinition rule = new RuleDefinition(expr, description);
        dataService.createRule(rule);
        return "redirect:/rulesConfig";
    }

    @GetMapping("/editRule/{id}")
    public String editRuleForm(@PathVariable Long id, Model model) {
        RuleDefinition rule = dataService.getRuleById(id);
        model.addAttribute("rule", rule);
        return "editRule";
    }

    @PostMapping("/updateRule")
    public String updateRule(@RequestParam Long id,
                             @RequestParam String expression,
                             @RequestParam String description) {
        RuleDefinition rule = dataService.getRuleById(id);
        if (rule != null) {
            rule.setExpression(expression);
            rule.setDescription(description);
            dataService.createRule(rule);
        }
        return "redirect:/rulesConfig";
    }
}
8.3) RanRulesController.java
Now doesn’t re-run rules. It just loads the stored results from ApplicationData.

java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.ApplicationData;
import com.example.rulesapp.service.DataService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

@Controller
@RequestMapping("/ranrules")
public class RanRulesController {

    private final DataService dataService;

    public RanRulesController(DataService dataService) {
        this.dataService = dataService;
    }

    @GetMapping
    public String viewRanRules(Model model) {
        model.addAttribute("applications", dataService.getAllApplications());
        return "ranrules";
    }

    @GetMapping("/details/{appId}")
    public String viewRuleDetails(@PathVariable Long appId, Model model) {
        ApplicationData application = dataService.getApplicationById(appId);
        if (application == null) {
            model.addAttribute("error", "Application not found.");
            return "ranrules";
        }

        model.addAttribute("application", application);

        // The stored results from the time of submission
        int totalRules = application.getStoredResults().size();
        int passedCount = (int) application.getStoredResults().stream().filter(r -> r.isPassed()).count();
        int failedCount = totalRules - passedCount;

        model.addAttribute("totalRules", totalRules);
        model.addAttribute("passedCount", passedCount);
        model.addAttribute("failedCount", failedCount);

        return "ranrulesDetails";
    }
}
8.4) TestController.java
Simple REST to verify up-time.

java
Copy
Edit
package com.example.rulesapp.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestController {
    @GetMapping("/test")
    public String test() {
        return "Test endpoint is working!";
    }
}
9) Thymeleaf Templates
Below, every page includes a “Home” link at the top that goes to "/home".

9.1) home.html
Lists applications (ID, final decision).
Each ID is a button that triggers a Bootstrap modal showing that application’s data.
We generate one modal per application.
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home - Rules App</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body {
            margin: 20px;
        }
        .app-item {
            margin-bottom: 8px;
        }
        .decision {
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Rules App - Home</h1>
    <hr/>

    <div class="mb-3">
        <a class="btn btn-primary" href="/createApplication">Create New Application</a>
    </div>

    <h2>Existing Applications</h2>
    <div>
        <div th:each="app : ${applications}" class="app-item">
            <strong>
                <!-- Button that opens a modal with ID appModal-${app.id} -->
                <a href="#" 
                   th:text="'ID: ' + ${app.id}"
                   th:attr="data-bs-toggle=modal, data-bs-target=${'#appModal-' + app.id}">
                </a>
            </strong>
            <span class="decision" th:text="${app.finalDecision}"></span>
        </div>
        <div th:if="${applications.size() == 0}">
            No applications found.
        </div>
    </div>

    <!-- For each application, define a bootstrap modal with the fieldValues. -->
    <div th:each="app : ${applications}">
        <div class="modal fade"
             th:id="${'appModal-' + app.id}"
             tabindex="-1"
             role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title"
                            th:text="'Application Data (ID: ' + ${app.id} + ')'">
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                    </div>

                    <div class="modal-body">
                        <p><strong>Final Decision:</strong>
                            <span th:text="${app.finalDecision}"></span>
                        </p>
                        <h6>Submitted Fields</h6>
                        <table class="table table-bordered">
                            <thead>
                                <tr><th>Field</th><th>Value</th></tr>
                            </thead>
                            <tbody>
                            <tr th:each="entry : ${app.fieldValues}">
                                <td th:text="${entry.key}"></td>
                                <td th:text="${entry.value}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                                data-bs-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>

<!-- Bootstrap 5 JS (for modal) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.2) createApplication.html
A form with all fields and their default values.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Create Application</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .field-group { margin-bottom: 10px; }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Create New Application</h1>
    <hr/>

    <form action="/submitApplication" method="post">
        <div th:each="field : ${fields}" class="field-group">
            <label th:text="${field.fieldName} + ' (' + field.fieldType + ')'"></label>
            <input type="hidden" name="fieldNames" th:value="${field.fieldName}"/>
            <input type="text" class="form-control"
                   name="fieldValues"
                   th:value="${fieldMap[field.fieldName]}"/>
        </div>
        <button class="btn btn-primary" type="submit">Submit Application</button>
        <a class="btn btn-secondary" href="/home">Cancel</a>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.3) rulesConfig.html
Manages fields/rules. A single-condition rule is built via field dropdown, operator dropdown, and a text value.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rules Config</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .block { margin-bottom: 30px; }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Rules Configuration</h1>
    <hr/>

    <div class="block">
        <h2>Existing Fields</h2>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>Field Name</th>
                <th>Field Type</th>
                <th>Default Value</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="field : ${fields}">
                <td th:text="${field.id}"></td>
                <td th:text="${field.fieldName}"></td>
                <td th:text="${field.fieldType}"></td>
                <td th:text="${field.defaultValue}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="block">
        <h3>Add Field</h3>
        <form action="/rulesConfig/addField" method="post" class="row g-3">
            <div class="col-md-3">
                <label>Field Name</label>
                <input class="form-control" type="text" name="fieldName" required/>
            </div>
            <div class="col-md-3">
                <label>Field Type</label>
                <input class="form-control" type="text" name="fieldType"
                       placeholder="TEXT, NUMBER, etc."/>
            </div>
            <div class="col-md-3">
                <label>Default Value</label>
                <input class="form-control" type="text" name="defaultValue"/>
            </div>
            <div class="col-md-3 align-self-end">
                <button class="btn btn-primary" type="submit">Add Field</button>
            </div>
        </form>
    </div>

    <hr/>
    <div class="block">
        <h2>Existing Rules</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Rule ID</th>
                <th>Expression</th>
                <th>Description</th>
                <th>Edit</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="rule : ${rules}">
                <td th:text="${rule.id}"></td>
                <td th:text="${rule.expression}"></td>
                <td th:text="${rule.description}"></td>
                <td>
                    <a class="btn btn-sm btn-info"
                       th:href="@{|/rulesConfig/editRule/${rule.id}|}">
                        Edit
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="block">
        <h3>Add Rule</h3>
        <form action="/rulesConfig/addRule" method="post" class="row g-3">

            <!-- Field dropdown -->
            <div class="col-md-3">
                <label>Field</label>
                <select name="selectedField" class="form-control">
                    <option th:each="f : ${fields}"
                            th:value="${f.fieldName}"
                            th:text="${f.fieldName}"></option>
                </select>
            </div>

            <!-- Operator dropdown -->
            <div class="col-md-2">
                <label>Operator</label>
                <select name="operator" class="form-control">
                    <option value=">">&gt;</option>
                    <option value=">=">&gt;=</option>
                    <option value="<">&lt;</option>
                    <option value="<=">&lt;=</option>
                    <option value="==">==</option>
                </select>
            </div>

            <!-- Value input -->
            <div class="col-md-2">
                <label>Value</label>
                <input class="form-control" type="text" name="ruleValue"/>
            </div>

            <!-- Description input -->
            <div class="col-md-3">
                <label>Description</label>
                <input class="form-control" type="text" name="description"/>
            </div>

            <div class="col-md-2 align-self-end">
                <button class="btn btn-primary" type="submit">Add Rule</button>
            </div>
        </form>
    </div>

    <hr/>
    <a class="btn btn-secondary" href="/home">Back to Home</a>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.4) editRule.html
Edit a rule’s expression/description.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Rule</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
    </nav>

    <h1>Edit Rule</h1>
    <hr/>

    <div th:if="${rule == null}">
        <p>Rule not found.</p>
        <a class="btn btn-secondary" href="/rulesConfig">Back</a>
    </div>

    <div th:if="${rule != null}">
        <form th:action="@{/rulesConfig/updateRule}" method="post">
            <input type="hidden" name="id" th:value="${rule.id}"/>
            <div class="mb-3">
                <label>Expression</label>
                <input class="form-control" type="text" name="expression"
                       th:value="${rule.expression}" required/>
            </div>
            <div class="mb-3">
                <label>Description</label>
                <input class="form-control" type="text" name="description"
                       th:value="${rule.description}"/>
            </div>
            <button class="btn btn-primary" type="submit">Update Rule</button>
            <a class="btn btn-secondary" href="/rulesConfig">Cancel</a>
        </form>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.5) ranrules.html
Lists all apps with their finalDecision. “View Details” goes to /ranrules/details/{appId}.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Ran Rules</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Ran Rules Page</h1>
    <hr/>

    <h2>All Applications</h2>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Application ID</th>
            <th>Final Decision</th>
            <th>Details</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="app : ${applications}">
            <td th:text="${app.id}"></td>
            <td th:text="${app.finalDecision}"></td>
            <td>
                <a class="btn btn-sm btn-info"
                   th:href="@{|/ranrules/details/${app.id}|}">
                    View Details
                </a>
            </td>
        </tr>
        </tbody>
    </table>

    <a class="btn btn-secondary" href="/home">Back to Home</a>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.6) ranrulesDetails.html
Shows final decision, how many total rules, passed, failed.
Also has a Bootstrap modal for the application data.
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rule Details</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .passed {
            color: green;
            font-weight: bold;
        }
        .failed {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">

    <!-- Nav bar with Home link -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
    </nav>

    <h1>Rule Evaluation Results</h1>
    <hr/>

    <div th:if="${error}">
        <p th:text="${error}"></p>
        <a class="btn btn-secondary" href="/ranrules">Back</a>
    </div>

    <div th:if="${application != null}">
        <p><strong>Application ID:</strong>
            <span th:text="${application.id}"></span>
        </p>
        <p><strong>Final Decision:</strong>
            <span th:text="${application.finalDecision}"></span>
        </p>
        <p>
            <strong>Ran </strong><span th:text="${totalRules}"></span>
            <strong> rule(s), Passed </strong><span th:text="${passedCount}"></span>,
            <strong> Failed </strong><span th:text="${failedCount}"></span>
        </p>

        <!-- Button to open a modal with the application data -->
        <button class="btn btn-primary"
                data-bs-toggle="modal"
                th:attr="data-bs-target=${'#appModal-' + application.id}">
            View Application Data
        </button>

        <hr/>
        <h3>Stored Rule Results</h3>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Rule ID</th>
                <th>Description</th>
                <th>Passed</th>
                <th>Message</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="r : ${application.storedResults}">
                <td th:text="${r.ruleId}"></td>
                <td th:text="${r.ruleDescription}"></td>
                <td th:classappend="${r.passed} ? 'passed' : 'failed'"
                    th:text="${r.passed} ? 'Yes' : 'No'"></td>
                <td th:text="${r.message}"></td>
            </tr>
            </tbody>
        </table>

        <a class="btn btn-secondary" href="/ranrules">Back</a>

        <!-- The modal for application data -->
        <div class="modal fade"
             th:id="${'appModal-' + application.id}"
             tabindex="-1"
             role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title"
                            th:text="'Application Data (ID: ' + ${application.id} + ')'">
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                    </div>

                    <div class="modal-body">
                        <p><strong>Final Decision:</strong>
                            <span th:text="${application.finalDecision}"></span>
                        </p>
                        <h6>Submitted Fields</h6>
                        <table class="table table-bordered">
                            <thead>
                            <tr><th>Field</th><th>Value</th></tr>
                            </thead>
                            <tbody>
                            <tr th:each="entry : ${application.fieldValues}">
                                <td th:text="${entry.key}"></td>
                                <td th:text="${entry.value}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                                data-bs-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<br/>
9.7) test.html (Optional)
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Test Page</title>
</head>
<body>
<h1>Test Page</h1>
<p>This is a simple placeholder page if you need Thymeleaf testing.</p>
</body>
</html>
How to Run
Build the project:
bash
Copy
Edit
mvn clean install
Run:
bash
Copy
Edit
mvn spring-boot:run
Open your browser:
http://localhost:8080/home – Lists applications (click ID to see data in a popup).
http://localhost:8080/createApplication – Fill out 30 fields, submit.
http://localhost:8080/rulesConfig – Manage fields & single-condition rules.
http://localhost:8080/ranrules – Lists apps with final decisions, “View Details” leads to a page showing stored rule results and a popup with application data.
http://localhost:8080/test – Test endpoint.
http://localhost:8080/h2-console (username: sa, no password) – H2 DB console.
Behavior
No rules initially => an application will show “Ran 0 rule(s), 0 passed, 0 failed.”
After you add some rules in /rulesConfig, new applications will be evaluated with those new rules. The older applications remain unaffected (they store their old zero-rule results).
On the home page, each application ID triggers a Bootstrap modal displaying that application’s data and final decision.
On the /ranrules → “View Details” page, you see a summary plus a table of each stored rule result, plus a button to open a modal with the app’s data.
This meets your requirements:

Popup with application data
Close option
Failed rule counts (and “Passed” rule counts)
“Initially no rules → 0 rules for older apps”
“Later rules don’t affect older apps.”
Enjoy!











