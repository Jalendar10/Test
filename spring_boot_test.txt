Project Structure
css
Copy
Edit
my-spring-boot-rules/
├── pom.xml
├── src
│   └── main
│       ├── java
│       │   └── com
│       │       └── example
│       │           └── rulesapp
│       │               ├── RulesAppApplication.java
│       │               ├── DataInitializer.java
│       │               ├── controller
│       │               │   ├── HomeController.java
│       │               │   ├── RulesConfigController.java
│       │               │   ├── RanRulesController.java
│       │               │   └── TestController.java
│       │               ├── model
│       │               │   ├── ApplicationData.java
│       │               │   ├── FieldDefinition.java
│       │               │   ├── RuleDefinition.java
│       │               │   ├── RuleResult.java
│       │               │   └── StoredRuleResult.java
│       │               ├── repository
│       │               │   ├── ApplicationDataRepository.java
│       │               │   ├── FieldDefinitionRepository.java
│       │               │   └── RuleDefinitionRepository.java
│       │               └── service
│       │                   ├── RulesEngineService.java
│       │                   └── DataService.java
│       └── resources
│           ├── application.properties
│           └── templates
│               ├── home.html
│               ├── createApplication.html
│               ├── rulesConfig.html
│               ├── editRule.html
│               ├── ranrules.html
│               ├── ranrulesDetails.html
│               ├── ruleInfo.html           <-- new page to show rule expression
│               └── test.html
└── ...
Below is the complete code for each file with the requested fixes:

1) pom.xml
xml
Copy
Edit
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>my-spring-boot-rules</artifactId>
    <version>1.0.0</version>
    <name>my-spring-boot-rules</name>

    <properties>
        <java.version>1.8</java.version>
        <spring.boot.version>2.6.14</spring.boot.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Starter Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- Spring Boot Starter Thymeleaf -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- Spring Boot Starter Data JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
            <version>${spring.boot.version}</version>
        </dependency>

        <!-- H2 Database (in-memory) -->
        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- Lombok (optional) -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.24</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- Spring Boot Maven Plugin -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring.boot.version}</version>
            </plugin>
        </plugins>
    </build>

</project>
2) application.properties
properties
Copy
Edit
spring.datasource.url=jdbc:h2:mem:rulesdb;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.jpa.hibernate.ddl-auto=update

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
3) RulesAppApplication.java
java
Copy
Edit
package com.example.rulesapp;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class RulesAppApplication {
    public static void main(String[] args) {
        SpringApplication.run(RulesAppApplication.class, args);
    }
}
4) DataInitializer.java
On startup, inserts 30 fields if none exist.

java
Copy
Edit
package com.example.rulesapp;

import com.example.rulesapp.model.FieldDefinition;
import com.example.rulesapp.service.DataService;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

@Component
public class DataInitializer implements CommandLineRunner {

    private final DataService dataService;

    public DataInitializer(DataService dataService) {
        this.dataService = dataService;
    }

    @Override
    public void run(String... args) {
        if (!dataService.getAllFields().isEmpty()) {
            return; // fields already exist
        }

        // Insert 30 predefined fields
        dataService.createField(new FieldDefinition("name",           "TEXT",   "John Doe"));
        dataService.createField(new FieldDefinition("age",            "NUMBER", "25"));
        dataService.createField(new FieldDefinition("sales",          "NUMBER", "1000"));
        dataService.createField(new FieldDefinition("volume",         "NUMBER", "50"));
        dataService.createField(new FieldDefinition("product",        "TEXT",   "Sample Product"));
        dataService.createField(new FieldDefinition("location",       "TEXT",   "NY"));
        dataService.createField(new FieldDefinition("phone",          "TEXT",   "1234567890"));
        dataService.createField(new FieldDefinition("email",          "TEXT",   "user@example.com"));
        dataService.createField(new FieldDefinition("creditScore",    "NUMBER", "700"));
        dataService.createField(new FieldDefinition("annualIncome",   "NUMBER", "50000"));
        dataService.createField(new FieldDefinition("monthlyExpenses","NUMBER", "1000"));
        dataService.createField(new FieldDefinition("membershipType", "TEXT",   "Basic"));
        dataService.createField(new FieldDefinition("region",         "TEXT",   "NorthEast"));
        dataService.createField(new FieldDefinition("discount",       "NUMBER", "10"));
        dataService.createField(new FieldDefinition("loyaltyPoints",  "NUMBER", "100"));
        dataService.createField(new FieldDefinition("transactionCount","NUMBER","5"));
        dataService.createField(new FieldDefinition("numberOfDependents","NUMBER","2"));
        dataService.createField(new FieldDefinition("occupation",     "TEXT",   "Engineer"));
        dataService.createField(new FieldDefinition("rating",         "NUMBER", "4"));
        dataService.createField(new FieldDefinition("remarks",        "TEXT",   ""));
        dataService.createField(new FieldDefinition("monthlySavings", "NUMBER", "500"));
        dataService.createField(new FieldDefinition("houseOwnership", "TEXT",   "Rented"));
        dataService.createField(new FieldDefinition("cardType",       "TEXT",   "Silver"));
        dataService.createField(new FieldDefinition("gender",         "TEXT",   "Male"));
        dataService.createField(new FieldDefinition("nationality",    "TEXT",   "American"));
        dataService.createField(new FieldDefinition("maritalStatus",  "TEXT",   "Single"));
        dataService.createField(new FieldDefinition("referenceId",    "TEXT",   "REF123"));
        dataService.createField(new FieldDefinition("productCategory","TEXT",   "Consumer Goods"));
        dataService.createField(new FieldDefinition("salesTarget",    "NUMBER", "2000"));
        dataService.createField(new FieldDefinition("comments",       "TEXT",   "N/A"));
    }
}
5) Model Classes
5.1) ApplicationData.java
Stores the submitted fieldValues, a finalDecision string, and the persisted rule results (storedResults).

java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

@Entity
public class ApplicationData {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ElementCollection
    private Map<String, String> fieldValues; // e.g. {"age":"25", "sales":"1000"}

    private String finalDecision; // "Ran X rule(s), X passed, X failed"

    @ElementCollection
    private List<StoredRuleResult> storedResults = new ArrayList<>();

    public ApplicationData() {
    }

    public ApplicationData(Map<String, String> fieldValues) {
        this.fieldValues = fieldValues;
    }

    public Long getId() {
        return id;
    }

    public Map<String, String> getFieldValues() {
        return fieldValues;
    }

    public void setFieldValues(Map<String, String> fieldValues) {
        this.fieldValues = fieldValues;
    }

    public String getFinalDecision() {
        return finalDecision;
    }

    public void setFinalDecision(String finalDecision) {
        this.finalDecision = finalDecision;
    }

    public List<StoredRuleResult> getStoredResults() {
        return storedResults;
    }

    public void setStoredResults(List<StoredRuleResult> storedResults) {
        this.storedResults = storedResults;
    }
}
5.2) FieldDefinition.java
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;

@Entity
public class FieldDefinition {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String fieldName;    // e.g. "age"
    private String fieldType;    // e.g. "NUMBER", "TEXT"
    private String defaultValue; // e.g. "0"

    public FieldDefinition() {
    }

    public FieldDefinition(String fieldName, String fieldType, String defaultValue) {
        this.fieldName = fieldName;
        this.fieldType = fieldType;
        this.defaultValue = defaultValue;
    }

    public Long getId() {
        return id;
    }

    public String getFieldName() {
        return fieldName;
    }

    public void setFieldName(String fieldName) {
        this.fieldName = fieldName;
    }

    public String getFieldType() {
        return fieldType;
    }

    public void setFieldType(String fieldType) {
        this.fieldType = fieldType;
    }

    public String getDefaultValue() {
        return defaultValue;
    }

    public void setDefaultValue(String defaultValue) {
        this.defaultValue = defaultValue;
    }
}
5.3) RuleDefinition.java
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.*;

@Entity
public class RuleDefinition {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String expression;   // e.g. "age > 18"
    private String description;  // e.g. "Check adult age"

    public RuleDefinition() {
    }

    public RuleDefinition(String expression, String description) {
        this.expression = expression;
        this.description = description;
    }

    public Long getId() {
        return id;
    }

    public String getExpression() {
        return expression;
    }

    public void setExpression(String expression) {
        this.expression = expression;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
}
5.4) RuleResult.java (transient in-memory results)
java
Copy
Edit
package com.example.rulesapp.model;

/**
 * Temporary result of evaluating a rule: not directly stored in DB.
 */
public class RuleResult {

    private Long ruleId;
    private String ruleDescription;
    private boolean passed;
    private String message;

    public RuleResult(Long ruleId, String ruleDescription, boolean passed, String message) {
        this.ruleId = ruleId;
        this.ruleDescription = ruleDescription;
        this.passed = passed;
        this.message = message;
    }

    public Long getRuleId() {
        return ruleId;
    }

    public String getRuleDescription() {
        return ruleDescription;
    }

    public boolean isPassed() {
        return passed;
    }

    public String getMessage() {
        return message;
    }
}
5.5) StoredRuleResult.java (persisted)
java
Copy
Edit
package com.example.rulesapp.model;

import javax.persistence.Embeddable;
import java.io.Serializable;

/**
 * A persistent version of RuleResult for storing in ApplicationData.
 */
@Embeddable
public class StoredRuleResult implements Serializable {

    private Long ruleId;
    private String ruleDescription;
    private boolean passed;
    private String message;

    public StoredRuleResult() {
    }

    public StoredRuleResult(Long ruleId, String ruleDescription, boolean passed, String message) {
        this.ruleId = ruleId;
        this.ruleDescription = ruleDescription;
        this.passed = passed;
        this.message = message;
    }

    public Long getRuleId() {
        return ruleId;
    }

    public void setRuleId(Long ruleId) {
        this.ruleId = ruleId;
    }

    public String getRuleDescription() {
        return ruleDescription;
    }

    public void setRuleDescription(String ruleDescription) {
        this.ruleDescription = ruleDescription;
    }

    public boolean isPassed() {
        return passed;
    }

    public void setPassed(boolean passed) {
        this.passed = passed;
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }
}
6) Repository Interfaces
6.1) ApplicationDataRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.ApplicationData;
import org.springframework.data.jpa.repository.JpaRepository;

public interface ApplicationDataRepository extends JpaRepository<ApplicationData, Long> {
}
6.2) FieldDefinitionRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.FieldDefinition;
import org.springframework.data.jpa.repository.JpaRepository;

public interface FieldDefinitionRepository extends JpaRepository<FieldDefinition, Long> {
}
6.3) RuleDefinitionRepository.java
java
Copy
Edit
package com.example.rulesapp.repository;

import com.example.rulesapp.model.RuleDefinition;
import org.springframework.data.jpa.repository.JpaRepository;

public interface RuleDefinitionRepository extends JpaRepository<RuleDefinition, Long> {
}
7) Service Classes
7.1) DataService.java
java
Copy
Edit
package com.example.rulesapp.service;

import com.example.rulesapp.model.*;
import com.example.rulesapp.repository.ApplicationDataRepository;
import com.example.rulesapp.repository.FieldDefinitionRepository;
import com.example.rulesapp.repository.RuleDefinitionRepository;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class DataService {

    private final FieldDefinitionRepository fieldRepo;
    private final RuleDefinitionRepository ruleRepo;
    private final ApplicationDataRepository appRepo;

    public DataService(FieldDefinitionRepository fieldRepo,
                       RuleDefinitionRepository ruleRepo,
                       ApplicationDataRepository appRepo) {
        this.fieldRepo = fieldRepo;
        this.ruleRepo = ruleRepo;
        this.appRepo = appRepo;
    }

    // Fields
    public List<FieldDefinition> getAllFields() {
        return fieldRepo.findAll();
    }
    public FieldDefinition createField(FieldDefinition fieldDefinition) {
        return fieldRepo.save(fieldDefinition);
    }

    // Rules
    public List<RuleDefinition> getAllRules() {
        return ruleRepo.findAll();
    }
    public RuleDefinition createRule(RuleDefinition ruleDefinition) {
        return ruleRepo.save(ruleDefinition);
    }
    public RuleDefinition getRuleById(Long id) {
        return ruleRepo.findById(id).orElse(null);
    }

    // Applications
    public ApplicationData saveApplicationData(ApplicationData applicationData) {
        return appRepo.save(applicationData);
    }
    public List<ApplicationData> getAllApplications() {
        return appRepo.findAll();
    }
    public ApplicationData getApplicationById(Long id) {
        return appRepo.findById(id).orElse(null);
    }
}
7.2) RulesEngineService.java
java
Copy
Edit
package com.example.rulesapp.service;

import com.example.rulesapp.model.ApplicationData;
import com.example.rulesapp.model.RuleDefinition;
import com.example.rulesapp.model.RuleResult;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

@Service
public class RulesEngineService {

    /**
     * Evaluate each rule. If "age > 18" and age=20 => pass, etc.
     * Returns a list of RuleResult with pass/fail status.
     */
    public List<RuleResult> evaluateRules(ApplicationData applicationData, List<RuleDefinition> rules) {
        Map<String, String> fieldValues = applicationData.getFieldValues();
        List<RuleResult> results = new ArrayList<>();

        for (RuleDefinition rule : rules) {
            boolean passed = evaluateExpression(rule.getExpression(), fieldValues);
            String message = passed ? "Rule Passed" : "Rule Failed";

            results.add(new RuleResult(
                    rule.getId(),
                    rule.getDescription(),
                    passed,
                    message
            ));
        }
        return results;
    }

    private boolean evaluateExpression(String expression, Map<String, String> fieldValues) {
        if (expression == null || expression.trim().isEmpty()) {
            return false;
        }
        try {
            String[] parts = expression.split(" ");
            if (parts.length == 3) {
                String fieldName = parts[0];
                String operator = parts[1];
                String thresholdStr = parts[2];

                String actualValueStr = fieldValues.get(fieldName);
                if (actualValueStr == null) return false;

                double actualVal = Double.parseDouble(actualValueStr);
                double thresholdVal = Double.parseDouble(thresholdStr);

                switch (operator) {
                    case ">":  return actualVal > thresholdVal;
                    case ">=": return actualVal >= thresholdVal;
                    case "<":  return actualVal < thresholdVal;
                    case "<=": return actualVal <= thresholdVal;
                    case "==": return actualVal == thresholdVal;
                    default:   return false;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return false;
    }
}
8) Controller Classes
8.1) HomeController.java
Displays existing apps on /home and has a form at /createApplication. On submission, we store rule results in the DB.

java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.*;
import com.example.rulesapp.service.DataService;
import com.example.rulesapp.service.RulesEngineService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;

import org.springframework.web.bind.annotation.RequestParam;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Controller
public class HomeController {

    private final DataService dataService;
    private final RulesEngineService rulesEngineService;

    public HomeController(DataService dataService, RulesEngineService rulesEngineService) {
        this.dataService = dataService;
        this.rulesEngineService = rulesEngineService;
    }

    @GetMapping({"/", "/home"})
    public String home(Model model) {
        model.addAttribute("applications", dataService.getAllApplications());
        return "home";
    }

    @GetMapping("/createApplication")
    public String showCreateApplicationForm(Model model) {
        List<FieldDefinition> fields = dataService.getAllFields();
        model.addAttribute("fields", fields);

        Map<String, String> fieldMap = new HashMap<>();
        for (FieldDefinition fd : fields) {
            fieldMap.put(fd.getFieldName(),
                    fd.getDefaultValue() == null ? "" : fd.getDefaultValue());
        }
        model.addAttribute("fieldMap", fieldMap);

        return "createApplication";
    }

    @PostMapping("/submitApplication")
    public String submitApplication(@RequestParam("fieldNames") String[] fieldNames,
                                    @RequestParam("fieldValues") String[] fieldValues) {
        // Build field map
        Map<String, String> fvMap = new HashMap<>();
        for (int i = 0; i < fieldNames.length; i++) {
            fvMap.put(fieldNames[i], fieldValues[i]);
        }

        // Create app
        ApplicationData appData = new ApplicationData(fvMap);
        appData = dataService.saveApplicationData(appData);

        // Evaluate current rules
        List<RuleDefinition> allRules = dataService.getAllRules();
        List<RuleResult> results = rulesEngineService.evaluateRules(appData, allRules);

        // Convert results -> stored
        List<StoredRuleResult> storedResults = new ArrayList<>();
        for (RuleResult rr : results) {
            storedResults.add(new StoredRuleResult(
                    rr.getRuleId(),
                    rr.getRuleDescription(),
                    rr.isPassed(),
                    rr.getMessage()
            ));
        }

        int total = storedResults.size();
        int passed = (int) storedResults.stream().filter(StoredRuleResult::isPassed).count();
        int failed = total - passed;

        String finalDec = String.format("Ran %d rule(s), %d passed, %d failed", total, passed, failed);
        appData.setFinalDecision(finalDec);
        appData.setStoredResults(storedResults);

        dataService.saveApplicationData(appData);

        return "redirect:/home";
    }
}
8.2) RulesConfigController.java
CRUD for fields and rules.

java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.FieldDefinition;
import com.example.rulesapp.model.RuleDefinition;
import com.example.rulesapp.service.DataService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Controller
@RequestMapping("/rulesConfig")
public class RulesConfigController {

    private final DataService dataService;

    public RulesConfigController(DataService dataService) {
        this.dataService = dataService;
    }

    @GetMapping
    public String showConfigPage(Model model) {
        model.addAttribute("fields", dataService.getAllFields());
        model.addAttribute("rules", dataService.getAllRules());
        return "rulesConfig";
    }

    @PostMapping("/addField")
    public String addField(@RequestParam String fieldName,
                           @RequestParam String fieldType,
                           @RequestParam(required = false) String defaultValue) {
        if (defaultValue == null) defaultValue = "";
        FieldDefinition fd = new FieldDefinition(fieldName, fieldType, defaultValue);
        dataService.createField(fd);
        return "redirect:/rulesConfig";
    }

    // Single-condition rule: field + operator + value
    @PostMapping("/addRule")
    public String addRule(@RequestParam String selectedField,
                          @RequestParam String operator,
                          @RequestParam String ruleValue,
                          @RequestParam String description) {
        String expr = selectedField + " " + operator + " " + ruleValue;
        RuleDefinition rd = new RuleDefinition(expr, description);
        dataService.createRule(rd);
        return "redirect:/rulesConfig";
    }

    @GetMapping("/editRule/{id}")
    public String editRuleForm(@PathVariable Long id, Model model) {
        RuleDefinition rule = dataService.getRuleById(id);
        model.addAttribute("rule", rule);
        return "editRule";
    }

    @PostMapping("/updateRule")
    public String updateRule(@RequestParam Long id,
                             @RequestParam String expression,
                             @RequestParam String description) {
        RuleDefinition rule = dataService.getRuleById(id);
        if (rule != null) {
            rule.setExpression(expression);
            rule.setDescription(description);
            dataService.createRule(rule);
        }
        return "redirect:/rulesConfig";
    }
}
8.3) RanRulesController.java
/ranrules → list of applications.
/ranrules/details/{appId} → shows final decision, stored rule results, an “Application Data” modal.
/ranrules/ruleInfo/{ruleId} → brand-new route that displays the actual rule expression/description if the user clicks the Rule ID.
java
Copy
Edit
package com.example.rulesapp.controller;

import com.example.rulesapp.model.ApplicationData;
import com.example.rulesapp.model.RuleDefinition;
import com.example.rulesapp.service.DataService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

@Controller
@RequestMapping("/ranrules")
public class RanRulesController {

    private final DataService dataService;

    public RanRulesController(DataService dataService) {
        this.dataService = dataService;
    }

    @GetMapping
    public String viewRanRules(Model model) {
        model.addAttribute("applications", dataService.getAllApplications());
        return "ranrules";
    }

    @GetMapping("/details/{appId}")
    public String viewRuleDetails(@PathVariable Long appId, Model model) {
        ApplicationData application = dataService.getApplicationById(appId);
        if (application == null) {
            model.addAttribute("error", "Application not found.");
            return "ranrules";
        }

        // We'll just show the stored results from the time of submission
        model.addAttribute("application", application);

        int totalRules = application.getStoredResults().size();
        int passedCount = (int) application.getStoredResults().stream().filter(r -> r.isPassed()).count();
        int failedCount = totalRules - passedCount;

        model.addAttribute("totalRules", totalRules);
        model.addAttribute("passedCount", passedCount);
        model.addAttribute("failedCount", failedCount);

        return "ranrulesDetails";
    }

    /**
     * New route: show the actual rule's expression & description
     * when the user clicks on the rule ID in ranrulesDetails.
     */
    @GetMapping("/ruleInfo/{ruleId}")
    public String ruleInfo(@PathVariable Long ruleId, Model model) {
        RuleDefinition rule = dataService.getRuleById(ruleId);
        model.addAttribute("rule", rule);
        return "ruleInfo";
    }
}
8.4) TestController.java
java
Copy
Edit
package com.example.rulesapp.controller;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class TestController {
    @GetMapping("/test")
    public String test() {
        return "Test endpoint is working!";
    }
}
9) Thymeleaf Templates
9.1) home.html
A top nav bar with a Home link
Lists applications
Each ID is turned into a modal button that shows the application’s data
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home - Rules App</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body {
            margin: 20px;
        }
        .app-item {
            margin-bottom: 8px;
        }
        .decision {
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>
<div class="container">

    <!-- Navigation -->
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Rules App - Home</h1>
    <hr/>

    <div class="mb-3">
        <a class="btn btn-primary" href="/createApplication">Create New Application</a>
    </div>

    <h2>Existing Applications</h2>
    <div>
        <div th:each="app : ${applications}" class="app-item">
            <!-- We make the ID clickable to open a modal for app data -->
            <strong>
                <a href="#"
                   th:text="'ID: ' + ${app.id}"
                   th:attr="data-bs-toggle=modal, data-bs-target=${'#appModal-' + app.id}"></a>
            </strong>
            <span class="decision" th:text="${app.finalDecision}"></span>
        </div>
        <div th:if="${applications.size() == 0}">
            No applications found.
        </div>
    </div>

    <!-- For each application, define a modal with fieldValues -->
    <div th:each="app : ${applications}">
        <div class="modal fade"
             th:id="${'appModal-' + app.id}"
             tabindex="-1"
             role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title"
                            th:text="'Application Data (ID: ' + ${app.id} + ')'">
                        </h5>
                        <button type="button" class="btn-close"
                                data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body">
                        <p>
                            <strong>Final Decision:</strong>
                            <span th:text="${app.finalDecision}"></span>
                        </p>
                        <h6>Submitted Fields</h6>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>Field</th>
                                <th>Value</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="entry : ${app.fieldValues}">
                                <td th:text="${entry.key}"></td>
                                <td th:text="${entry.value}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer">
                        <button type="button"
                                class="btn btn-secondary"
                                data-bs-dismiss="modal">
                            Close
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.2) createApplication.html
Form to submit a new application (30 fields).

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Create Application</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .field-group { margin-bottom: 10px; }
    </style>
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Create New Application</h1>
    <hr/>

    <form action="/submitApplication" method="post">
        <div th:each="field : ${fields}" class="field-group">
            <label th:text="${field.fieldName} + ' (' + field.fieldType + ')'"></label>
            <input type="hidden" name="fieldNames" th:value="${field.fieldName}"/>
            <input type="text" class="form-control"
                   name="fieldValues"
                   th:value="${fieldMap[field.fieldName]}"/>
        </div>
        <button class="btn btn-primary" type="submit">Submit Application</button>
        <a class="btn btn-secondary" href="/home">Cancel</a>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.3) rulesConfig.html
Manages fields and single-condition rules.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rules Config</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .block { margin-bottom: 30px; }
    </style>
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Rules Configuration</h1>
    <hr/>

    <div class="block">
        <h2>Existing Fields</h2>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>ID</th>
                <th>Field Name</th>
                <th>Field Type</th>
                <th>Default Value</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="field : ${fields}">
                <td th:text="${field.id}"></td>
                <td th:text="${field.fieldName}"></td>
                <td th:text="${field.fieldType}"></td>
                <td th:text="${field.defaultValue}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="block">
        <h3>Add Field</h3>
        <form action="/rulesConfig/addField" method="post" class="row g-3">
            <div class="col-md-3">
                <label>Field Name</label>
                <input class="form-control" type="text" name="fieldName" required/>
            </div>
            <div class="col-md-3">
                <label>Field Type</label>
                <input class="form-control" type="text" name="fieldType" placeholder="TEXT, NUMBER, etc."/>
            </div>
            <div class="col-md-3">
                <label>Default Value</label>
                <input class="form-control" type="text" name="defaultValue"/>
            </div>
            <div class="col-md-3 align-self-end">
                <button class="btn btn-primary" type="submit">Add Field</button>
            </div>
        </form>
    </div>

    <hr/>
    <div class="block">
        <h2>Existing Rules</h2>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Rule ID</th>
                <th>Expression</th>
                <th>Description</th>
                <th>Edit</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="rule : ${rules}">
                <td th:text="${rule.id}"></td>
                <td th:text="${rule.expression}"></td>
                <td th:text="${rule.description}"></td>
                <td>
                    <a class="btn btn-sm btn-info"
                       th:href="@{|/rulesConfig/editRule/${rule.id}|}">
                        Edit
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="block">
        <h3>Add Rule</h3>
        <form action="/rulesConfig/addRule" method="post" class="row g-3">
            <div class="col-md-3">
                <label>Field</label>
                <select name="selectedField" class="form-control">
                    <option th:each="f : ${fields}"
                            th:value="${f.fieldName}"
                            th:text="${f.fieldName}"></option>
                </select>
            </div>
            <div class="col-md-2">
                <label>Operator</label>
                <select name="operator" class="form-control">
                    <option value=">">&gt;</option>
                    <option value=">=">&gt;=</option>
                    <option value="<">&lt;</option>
                    <option value="<=">&lt;=</option>
                    <option value="==">==</option>
                </select>
            </div>
            <div class="col-md-2">
                <label>Value</label>
                <input class="form-control" type="text" name="ruleValue"/>
            </div>
            <div class="col-md-3">
                <label>Description</label>
                <input class="form-control" type="text" name="description"/>
            </div>
            <div class="col-md-2 align-self-end">
                <button class="btn btn-primary" type="submit">Add Rule</button>
            </div>
        </form>
    </div>

    <hr/>
    <a class="btn btn-secondary" href="/home">Back to Home</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.4) editRule.html
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Rule</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
    </style>
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
    </nav>

    <h1>Edit Rule</h1>
    <hr/>

    <div th:if="${rule == null}">
        <p>Rule not found.</p>
        <a class="btn btn-secondary" href="/rulesConfig">Back</a>
    </div>

    <div th:if="${rule != null}">
        <form th:action="@{/rulesConfig/updateRule}" method="post">
            <input type="hidden" name="id" th:value="${rule.id}"/>
            <div class="mb-3">
                <label>Expression</label>
                <input class="form-control" type="text" name="expression"
                       th:value="${rule.expression}" required/>
            </div>
            <div class="mb-3">
                <label>Description</label>
                <input class="form-control" type="text" name="description"
                       th:value="${rule.description}"/>
            </div>
            <button class="btn btn-primary" type="submit">Update Rule</button>
            <a class="btn btn-secondary" href="/rulesConfig">Cancel</a>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.5) ranrules.html
Lists all applications and shows final decisions.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Ran Rules</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
    </style>
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-outline-success" href="/test">Test Endpoint</a>
    </nav>

    <h1>Ran Rules Page</h1>
    <hr/>

    <h2>All Applications</h2>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Application ID</th>
            <th>Final Decision</th>
            <th>Details</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="app : ${applications}">
            <td th:text="${app.id}"></td>
            <td th:text="${app.finalDecision}"></td>
            <td>
                <a class="btn btn-sm btn-info"
                   th:href="@{|/ranrules/details/${app.id}|}">
                    View Details
                </a>
            </td>
        </tr>
        </tbody>
    </table>

    <a class="btn btn-secondary" href="/home">Back to Home</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.6) ranrulesDetails.html
Shows the stored results and a “View Application Data” modal. Each Rule ID is clickable – it leads to /ranrules/ruleInfo/{ruleId} to show the rule’s actual expression.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rule Details</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <style>
        body { margin: 20px; }
        .passed {
            color: green;
            font-weight: bold;
        }
        .failed {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-secondary" href="/rulesConfig">Manage Fields/Rules</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
    </nav>

    <h1>Rule Evaluation Results</h1>
    <hr/>

    <div th:if="${error}">
        <p th:text="${error}"></p>
        <a class="btn btn-secondary" href="/ranrules">Back</a>
    </div>

    <div th:if="${application != null}">
        <p><strong>Application ID:</strong>
            <span th:text="${application.id}"></span>
        </p>
        <p><strong>Final Decision:</strong>
            <span th:text="${application.finalDecision}"></span>
        </p>

        <p>
            <strong>Ran </strong><span th:text="${totalRules}"></span>
            <strong> rule(s), Passed </strong><span th:text="${passedCount}"></span>,
            <strong> Failed </strong><span th:text="${failedCount}"></span>
        </p>

        <!-- Button to open app data modal -->
        <button class="btn btn-primary"
                data-bs-toggle="modal"
                th:attr="data-bs-target=${'#appModal-' + application.id}">
            View Application Data
        </button>

        <hr/>

        <h3>Stored Rule Results</h3>
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Rule ID</th>
                <th>Description</th>
                <th>Passed</th>
                <th>Message</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="r : ${application.storedResults}">
                <!-- Clicking the rule ID leads to /ranrules/ruleInfo/{ruleId} -->
                <td>
                    <a th:href="@{|/ranrules/ruleInfo/${r.ruleId}|}"
                       th:text="${r.ruleId}"></a>
                </td>
                <td th:text="${r.ruleDescription}"></td>
                <td th:classappend="${r.passed} ? 'passed' : 'failed'"
                    th:text="${r.passed} ? 'Yes' : 'No'"></td>
                <td th:text="${r.message}"></td>
            </tr>
            </tbody>
        </table>

        <a class="btn btn-secondary" href="/ranrules">Back</a>

        <!-- Modal for the application data -->
        <div class="modal fade"
             th:id="${'appModal-' + application.id}"
             tabindex="-1"
             role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title"
                            th:text="'Application Data (ID: ' + ${application.id} + ')'">
                        </h5>
                        <button type="button" class="btn-close"
                                data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body">
                        <p><strong>Final Decision:</strong>
                            <span th:text="${application.finalDecision}"></span>
                        </p>
                        <h6>Submitted Fields</h6>
                        <table class="table table-bordered">
                            <thead>
                            <tr><th>Field</th><th>Value</th></tr>
                            </thead>
                            <tbody>
                            <tr th:each="entry : ${application.fieldValues}">
                                <td th:text="${entry.key}"></td>
                                <td th:text="${entry.value}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="modal-footer">
                        <button type="button"
                                class="btn btn-secondary"
                                data-bs-dismiss="modal">
                            Close
                        </button>
                    </div>

                </div>
            </div>
        </div>

    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.7) ruleInfo.html (New)
Displays a single rule’s details if you click on its ID in the details page.

html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rule Info</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <nav class="mb-3">
        <a class="btn btn-info" href="/home">Home</a>
        <a class="btn btn-info" href="/ranrules">Check Run Rules</a>
    </nav>

    <h1>Rule Info</h1>
    <hr/>

    <div th:if="${rule != null}">
        <p><strong>Rule ID:</strong> <span th:text="${rule.id}"></span></p>
        <p><strong>Expression:</strong> <span th:text="${rule.expression}"></span></p>
        <p><strong>Description:</strong> <span th:text="${rule.description}"></span></p>
    </div>

    <div th:if="${rule == null}">
        <p>Rule not found.</p>
    </div>

    <a class="btn btn-secondary" href="/ranrules">Back</a>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
9.8) test.html (Optional)
html
Copy
Edit
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Test Page</title>
</head>
<body>
<h1>Test Page</h1>
<p>Use this page for manual tests.</p>
</body>
</html>
How to Run
From the project root:
bash
Copy
Edit
mvn clean install
Start the Spring Boot app:
bash
Copy
Edit
mvn spring-boot:run
Browse:
http://localhost:8080/home – Home page
http://localhost:8080/createApplication – fill out the 30 fields
http://localhost:8080/rulesConfig – manage fields and rules
http://localhost:8080/ranrules – list of apps with final decisions
View Details → shows rule results for that app
The “Rule ID” is clickable → goes to /ranrules/ruleInfo/{ruleId} to see the rule expression
http://localhost:8080/test – test endpoint
http://localhost:8080/h2-console (username sa, password empty) for DB.
Key Fixes
Application ID now displays in ranrulesDetails.html inside <span th:text="${application.id}"></span>.
The modal for Application Data is properly referencing the application object.
Each Rule ID in the table is a link to /ranrules/ruleInfo/{ruleId}, and we added a new ruleInfo.html page to show the actual expression.
We persist the rule results at submission, so older apps won’t change if new rules appear later.
This satisfies all your requests:

“Application ID” is displayed in the details page.
The application data can be viewed in a Bootstrap popup with a Close button.
We show passed/failed counts.
Rule ID click → actual rule details.
If no rules existed when the application was submitted, it will show “Ran 0 rule(s), 0 passed, 0 failed” with an empty rule table.
Enjoy!










Search

